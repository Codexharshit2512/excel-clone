{"version":3,"sources":["script.js"],"names":["ps","PerfectScrollbar","wheelSpeed","wheelPropagation","defaultProperties","text","bold","italic","underlined","alignment","color","bgcolor","formula","upStream","downStream","i","n","str","rem","Math","floor","String","fromCharCode","$","append","sheetSelectedForSomeAction","cellData","sheets","Sheet1","saved","selectedSheet","totalSheets","lastSheetAdded","row","j","getRowColId","elem","classArr","attr","split","parseInt","grabAdjacentCells","rowId","colId","topCell","bottomCell","leftCell","getSelectedBooleans","rightCell","topSelected","rightSelected","bottomSelected","leftSelected","hasClass","selectCell","e","cell","ctrlKey","addClass","removeClass","changeHeader","unselectCells","blur","on","console","log","dblclick","focus","updateCellData","clipBoard","contentCutted","startCellSelected","startCell","endCell","selectBetweenCell","start","end","min","max","data","rest","setHeaderStyle","css","val","id","property","addSheetListeners","click","emptyPreviousSheet","loadNewSheet","preventDefault","selectSheet","remove","left","pageX","handleRenameSheet","handleDeleteSheet","rowKeys","Object","keys","colKeys","modal","includes","copySheets","forEach","sheet","each","index","deletedSheet","length","idx","value","oldCellData","JSON","stringify","undefined","openNewFile","saveFile","newClicked","saveModal","a","document","createElement","href","encodeURIComponent","download","openFile","inputFile","change","file","target","files","name","reader","FileReader","readAsText","onload","parse","result","lastlyAddedSheet","splittedSheetArray","isNaN","updateStream","elements","selfCode","mousemove","buttons","mouseenter","align","toggleClass","scroll","scrollLeft","scrollTop","colorPick","initialColor","allowRecent","recentMax","allowCustomColor","palette","onColorSelected","element","children","scrollIntoView","behaviour","indexOf","num","fileModal","stopPropagation","stopImmediatePropagation","sureModal","col","sCell","rows","cols","rowDiff","colDiff","splitArr","replace","push","alert"],"mappings":"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","file":"script.9234de09.js","sourceRoot":"..","sourcesContent":["const ps = new PerfectScrollbar(\"#cells\", {\r\n  wheelSpeed: 10,\r\n  wheelPropagation: true,\r\n});\r\n\r\nlet defaultProperties = {\r\n  \"font-family\": \"Noto Sans\",\r\n  \"font-size\": 14,\r\n  text: \"\",\r\n  bold: false,\r\n  italic: false,\r\n  underlined: false,\r\n  alignment: \"left\",\r\n  color: \"#444\",\r\n  bgcolor: \"#fff\",\r\n  formula: \"\",\r\n  upStream: [],\r\n  downStream: [],\r\n};\r\n\r\nfor (let i = 1; i <= 100; i++) {\r\n  let str = \"\";\r\n  let n = i;\r\n\r\n  while (n > 0) {\r\n    let rem = n % 26;\r\n    if (rem == 0) {\r\n      str = \"Z\" + str;\r\n      n = Math.floor(n / 26) - 1;\r\n    } else {\r\n      str = String.fromCharCode(rem - 1 + 65) + str;\r\n      n = Math.floor(n / 26);\r\n    }\r\n  }\r\n  $(\"#columns\").append(\r\n    `<div class=\"column-name column-${i}\" id=\"${str}\">${str}</div>`\r\n  );\r\n  $(\"#rows\").append(`<div class=\"row-name ${i}\">${i}</div>`);\r\n}\r\nlet cellData = [];\r\nlet sheets = {\r\n  Sheet1: {},\r\n};\r\nlet saved = true;\r\nlet selectedSheet = \"Sheet1\";\r\nlet totalSheets = 1;\r\nlet lastSheetAdded = 1;\r\nlet sheetSelectedForSomeAction;\r\nfor (let i = 1; i <= 100; i++) {\r\n  let row = $('<div class=\"cell-row\"></div>');\r\n  // let rowData = [];\r\n  for (let j = 1; j <= 100; j++) {\r\n    row.append(\r\n      `<div id=\"row-${i}-col-${j}\" class=\"input-cell\" contenteditable=\"false\"></div>`\r\n    );\r\n    // rowData.push({ ...defaultProperties });\r\n  }\r\n  $(\"#cells\").append(row);\r\n  // cellData.push(rowData);\r\n}\r\n\r\nfunction getRowColId(elem) {\r\n  const classArr = $(elem).attr(\"id\").split(\"-\");\r\n  const rowId = parseInt(classArr[1]);\r\n  const colId = parseInt(classArr[3]);\r\n  return [rowId, colId];\r\n}\r\n\r\nfunction grabAdjacentCells(elem) {\r\n  const classArr = $(elem).attr(\"id\").split(\"-\");\r\n  const rowId = parseInt(classArr[1]);\r\n  const colId = parseInt(classArr[3]);\r\n  // console.log(cellData[rowId - 1][colId - 1]);\r\n  let topCell = $(`#row-${rowId - 1}-col-${colId}`);\r\n  let bottomCell = $(`#row-${rowId + 1}-col-${colId}`);\r\n  let leftCell = $(`#row-${rowId}-col-${colId - 1}`);\r\n  let rightCell = $(`#row-${rowId}-col-${colId + 1}`);\r\n  return [topCell, rightCell, bottomCell, leftCell];\r\n}\r\n\r\n$(\".input-cell\").on(\"click\", function (e) {\r\n  // console.log($(this));\r\n  console.log(sheets);\r\n  const [topCell, rightCell, bottomCell, leftCell] = grabAdjacentCells(this);\r\n  // console.log(topCell.length);\r\n  // if (topCell.length) console.log(\"topcell exists\");\r\n  if ($(this).hasClass(\"selected\") && e.ctrlKey) {\r\n    // unselectCell(this, e, topCell, bottomCell, leftCell, rightCell);\r\n    return unselectCells(this, topCell, rightCell, bottomCell, leftCell);\r\n  } else {\r\n    selectCell(e, this, topCell, rightCell, bottomCell, leftCell);\r\n  }\r\n  // const [rowId, colId] = getRowColId(this);\r\n  // console.log(cellData[rowId - 1][colId - 1]);\r\n});\r\n\r\n$(\".input-cell\").dblclick(function (e) {\r\n  $(this).attr(\"contenteditable\", true);\r\n  $(this).focus();\r\n});\r\n\r\n$(\".input-cell\").blur(function (e) {\r\n  $(this).attr(\"contenteditable\", false);\r\n  updateCellData(\"text\", $(this).text());\r\n});\r\n\r\nfunction getSelectedBooleans(topCell, rightCell, bottomCell, leftCell) {\r\n  let topSelected, rightSelected, bottomSelected, leftSelected;\r\n  // console.log(e.ctrlKey);\r\n\r\n  if (topCell) {\r\n    topSelected = topCell.hasClass(\"selected\");\r\n  }\r\n\r\n  if (bottomCell) {\r\n    bottomSelected = bottomCell.hasClass(\"selected\");\r\n  }\r\n\r\n  if (rightCell) {\r\n    rightSelected = rightCell.hasClass(\"selected\");\r\n  }\r\n\r\n  if (leftCell) {\r\n    leftSelected = leftCell.hasClass(\"selected\");\r\n  }\r\n\r\n  return [topSelected, rightSelected, bottomSelected, leftSelected];\r\n}\r\n\r\nfunction selectCell(e, cell, topCell, rightCell, bottomCell, leftCell) {\r\n  if (e.ctrlKey) {\r\n    // if ($(cell).hasClass(\"selected\")) {\r\n    //   return unselectCells(cell, topCell, rightCell, bottomCell, leftCell);\r\n    // }\r\n\r\n    const [topSelected, rightSelected, bottomSelected, leftSelected] =\r\n      getSelectedBooleans(topCell, rightCell, bottomCell, leftCell);\r\n\r\n    if (topSelected) {\r\n      $(cell).addClass(\"top-selected\");\r\n      topCell.addClass(\"bottom-selected\");\r\n    }\r\n\r\n    if (rightSelected) {\r\n      $(cell).addClass(\"right-selected\");\r\n      rightCell.addClass(\"left-selected\");\r\n    }\r\n\r\n    if (bottomSelected) {\r\n      $(cell).addClass(\"bottom-selected\");\r\n      bottomCell.addClass(\"top-selected\");\r\n    }\r\n\r\n    if (leftSelected) {\r\n      $(cell).addClass(\"left-selected\");\r\n      leftCell.addClass(\"right-selected\");\r\n    }\r\n  } else {\r\n    $(\".input-cell.selected\").removeClass(\r\n      \"selected top-selected bottom-selected left-selected right-selected\"\r\n    );\r\n  }\r\n  $(cell).addClass(\"selected\");\r\n  changeHeader(getRowColId(cell));\r\n}\r\n\r\nfunction unselectCells(cell, topCell, rightCell, bottomCell, leftCell) {\r\n  const [topSelected, rightSelected, bottomSelected, leftSelected] =\r\n    getSelectedBooleans(topCell, rightCell, bottomCell, leftCell);\r\n  if (topSelected) {\r\n    topCell.removeClass(\"bottom-selected\");\r\n    $(cell).removeClass(\"top-selected\");\r\n  }\r\n\r\n  if (rightSelected) {\r\n    rightCell.removeClass(\"left-selected\");\r\n    $(cell).removeClass(\"right-selected\");\r\n  }\r\n\r\n  if (bottomSelected) {\r\n    bottomCell.removeClass(\"top-selected\");\r\n    $(cell).removeClass(\"bottom-selected\");\r\n  }\r\n\r\n  if (leftSelected) {\r\n    leftCell.removeClass(\"right-selected\");\r\n    $(cell).removeClass(\"left-selected\");\r\n  }\r\n\r\n  $(cell).removeClass(\"selected\");\r\n  $(cell).blur();\r\n}\r\nlet startCellSelected = false;\r\nlet startCell = {};\r\nlet endCell = {};\r\n$(\".input-cell\").mousemove(function (e) {\r\n  e.preventDefault();\r\n  if (e.buttons == 1) {\r\n    if (!startCellSelected) {\r\n      startCellSelected = true;\r\n      let [rowId, colId] = getRowColId(this);\r\n      startCell = { rowId, colId };\r\n      // console.log(\"sc \", startCell);\r\n      //\r\n    }\r\n  } else {\r\n    startCellSelected = false;\r\n  }\r\n});\r\n\r\n$(\".input-cell\").mouseenter(function (e) {\r\n  if (e.buttons == 1) {\r\n    let [rowId, colId] = getRowColId(this);\r\n    endCell = { rowId, colId };\r\n    // console.log(\"ec\", endCell);\r\n    selectBetweenCell(startCell, endCell);\r\n  }\r\n});\r\n\r\nfunction selectBetweenCell(start, end) {\r\n  $(\".input-cell.selected\").removeClass(\r\n    \"selected top-selected bottom-selected left-selected right-selected\"\r\n  );\r\n  // console.log(start, end);\r\n  for (\r\n    let i = Math.min(start.rowId, end.rowId);\r\n    i <= Math.max(start.rowId, end.rowId);\r\n    i++\r\n  ) {\r\n    for (\r\n      let j = Math.min(start.colId, end.colId);\r\n      j <= Math.max(start.colId, end.colId);\r\n      j++\r\n    ) {\r\n      const cell = $(`#row-${i}-col-${j}`)[0];\r\n      const [topCell, rightCell, bottomCell, leftCell] =\r\n        grabAdjacentCells(cell);\r\n\r\n      selectCell(\r\n        { ctrlKey: true },\r\n        cell,\r\n        topCell,\r\n        rightCell,\r\n        bottomCell,\r\n        leftCell\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nfunction changeHeader([rowId, colId]) {\r\n  if (\r\n    sheets[selectedSheet][rowId - 1] &&\r\n    sheets[selectedSheet][rowId - 1][colId - 1]\r\n  ) {\r\n    const {\r\n      alignment: data,\r\n      bold,\r\n      italic,\r\n      underlined,\r\n      ...rest\r\n    } = sheets[selectedSheet][rowId - 1][colId - 1];\r\n    $(\".alignment\").removeClass(\"selected\");\r\n    $(`.alignment[data-type=${data}]`).addClass(\"selected\");\r\n    setHeaderStyle(\"#bold\", bold);\r\n    setHeaderStyle(\"#italic\", italic);\r\n    setHeaderStyle(\"#underlined\", underlined);\r\n    $(\"#fill-color\").css(\"border-color\", rest.bgcolor);\r\n    $(\"#text-color\").css(\"border-color\", rest.color);\r\n    $(\"#font-family\").val(rest[\"font-family\"]);\r\n    $(\"#font-size\").val(rest[\"font-size\"]);\r\n    $(\"#font-family\").css(\"font-family\", rest[\"font-family\"]);\r\n  } else {\r\n    $(\".alignment\").removeClass(\"selected\");\r\n    $(`.alignment[data-type=left]`).addClass(\"selected\");\r\n    setHeaderStyle(\"#bold\", defaultProperties[\"bold\"]);\r\n    setHeaderStyle(\"#italic\", defaultProperties[\"italic\"]);\r\n    setHeaderStyle(\"#underlined\", defaultProperties[\"underlined\"]);\r\n    $(\"#fill-color\").css(\"border-color\", defaultProperties[\"bgcolor\"]);\r\n    $(\"#text-color\").css(\"border-color\", defaultProperties[\"color\"]);\r\n    $(\"#font-family\").val(defaultProperties[\"font-family\"]);\r\n    $(\"#font-size\").val(defaultProperties[\"font-size\"]);\r\n    $(\"#font-family\").css(\"font-family\", defaultProperties[\"font-family\"]);\r\n  }\r\n}\r\n\r\nfunction setHeaderStyle(id, property) {\r\n  if (property) $(id).addClass(\"selected\");\r\n  else $(id).removeClass(\"selected\");\r\n}\r\n\r\n$(`.alignment`).click(function (e) {\r\n  $(\".alignment\").removeClass(\"selected\");\r\n  $(this).addClass(\"selected\");\r\n  let align = $(this).attr(\"data-type\");\r\n  $(\".input-cell.selected\").css(\"text-align\", align);\r\n  updateCellData(\"alignment\", align);\r\n});\r\n\r\n$(\"#bold\").click(function (e) {\r\n  if (!$(this).hasClass(\"selected\")) {\r\n    $(\".input-cell.selected\").css(\"font-weight\", \"bold\");\r\n    updateCellData(\"bold\", true);\r\n  } else {\r\n    $(\".input-cell.selected\").css(\"font-weight\", 400);\r\n    updateCellData(\"bold\", false);\r\n  }\r\n  $(this).toggleClass(\"selected\");\r\n});\r\n\r\n$(\"#italic\").click(function (e) {\r\n  if (!$(this).hasClass(\"selected\")) {\r\n    $(\".input-cell.selected\").css(\"font-style\", \"italic\");\r\n    updateCellData(\"italic\", true);\r\n  } else {\r\n    $(\".input-cell.selected\").css(\"font-style\", \"normal\");\r\n    updateCellData(\"italic\", false);\r\n  }\r\n  $(this).toggleClass(\"selected\");\r\n});\r\n\r\n$(\"#underlined\").click(function (e) {\r\n  if (!$(this).hasClass(\"selected\")) {\r\n    $(\".input-cell.selected\").css(\"text-decoration\", \"underline\");\r\n    updateCellData(\"underlined\", true);\r\n  } else {\r\n    $(\".input-cell.selected\").css(\"text-decoration\", \"none\");\r\n    updateCellData(\"underlined\", false);\r\n  }\r\n  $(this).toggleClass(\"selected\");\r\n});\r\n\r\n$(\"#cells\").scroll(function (e) {\r\n  $(\"#columns\").scrollLeft(this.scrollLeft);\r\n  $(\"#rows\").scrollTop(this.scrollTop);\r\n});\r\n// $(\".pick-color\").click(() => console.log(\"cliecked\"));\r\n$(\".pick-color\").colorPick({\r\n  initialColor: \"#abcd\",\r\n  allowRecent: true,\r\n  recentMax: 5,\r\n  allowCustomColor: false,\r\n  palette: [\r\n    \"#1abc9c\",\r\n    \"#16a085\",\r\n    \"#2ecc71\",\r\n    \"#27ae60\",\r\n    \"#3498db\",\r\n    \"#2980b9\",\r\n    \"#9b59b6\",\r\n    \"#8e44ad\",\r\n    \"#34495e\",\r\n    \"#2c3e50\",\r\n    \"#f1c40f\",\r\n    \"#f39c12\",\r\n    \"#e67e22\",\r\n    \"#d35400\",\r\n    \"#e74c3c\",\r\n    \"#c0392b\",\r\n    \"#ecf0f1\",\r\n    \"#bdc3c7\",\r\n    \"#95a5a6\",\r\n    \"#7f8c8d\",\r\n  ],\r\n  onColorSelected: function () {\r\n    // this.element.css({ backgroundColor: this.color, color: this.color });\r\n    if (this.color != \"#ABCD\") {\r\n      const id = $(this.element.children()[1]).attr(\"id\");\r\n      // console.log(id);\r\n      $(this.element.children()[1]).css(\"border-color\", this.color);\r\n      if (id == \"fill-color\") {\r\n        $(\".input-cell.selected\").css(\"background-color\", this.color);\r\n        updateCellData(\"bgcolor\", this.color);\r\n      } else {\r\n        $(\".input-cell.selected\").css(\"color\", this.color);\r\n        updateCellData(\"color\", this.color);\r\n      }\r\n    }\r\n\r\n    // console.log(this.element.children()[0]);\r\n  },\r\n});\r\n\r\n$(\".add-sheet\").click(function (e) {\r\n  totalSheets++;\r\n  lastSheetAdded++;\r\n  $(\".sheet-tab\").removeClass(\"selected\");\r\n  $(\".sheet-tab-container\").append(\r\n    `<div class=\"sheet-tab selected\">Sheet${lastSheetAdded}</div>`\r\n  );\r\n  sheets[$(\".sheet-tab.selected\").text()] = {};\r\n  addSheetListeners();\r\n  emptyPreviousSheet();\r\n  selectedSheet = $(\".sheet-tab.selected\").text();\r\n  $(\".sheet-tab.selected\")[0].scrollIntoView({ behaviour: \"smooth\" });\r\n  saved = false;\r\n});\r\n\r\nfunction addSheetListeners() {\r\n  $(\".sheet-tab.selected\").click(function (e) {\r\n    if ($(this).text() != selectedSheet) {\r\n      $(\".sheet-tab\").removeClass(\"selected\");\r\n      $(this).addClass(\"selected\");\r\n      emptyPreviousSheet();\r\n      selectedSheet = $(this).text();\r\n      $(\".sheet-tab\").removeClass(\"selected\");\r\n      $(this).addClass(\"selected\");\r\n      loadNewSheet();\r\n    }\r\n  });\r\n  $(\".sheet-tab.selected\").on(\"contextmenu\", function (e) {\r\n    e.preventDefault();\r\n    selectSheet(this);\r\n    $(\".sheet-options-modal\").remove();\r\n    $(\".container\").append(`<div class=\"sheet-options-modal\">\r\n    <div class=\"option sheet-rename\">Rename</div>\r\n    <div class=\"option sheet-delete\">Delete</div>\r\n  </div>`);\r\n    $(\".sheet-options-modal\").css({\r\n      left: e.pageX,\r\n    });\r\n    $(\".sheet-rename\").click(handleRenameSheet);\r\n    $(\".sheet-delete\").click(handleDeleteSheet);\r\n  });\r\n}\r\n\r\n$(\".sheet-tab\").on(\"contextmenu\", function (e) {\r\n  e.preventDefault();\r\n  console.log(\"clicked context\");\r\n  selectSheet(this);\r\n  $(\".sheet-options-modal\").remove();\r\n  $(\".container\").append(`<div class=\"sheet-options-modal\">\r\n  <div class=\"option sheet-rename\">Rename</div>\r\n  <div class=\"option sheet-delete\">Delete</div>\r\n</div>`);\r\n  $(\".sheet-options-modal\").css({\r\n    left: e.pageX,\r\n  });\r\n  $(\".sheet-rename\").click(handleRenameSheet);\r\n  $(\".sheet-delete\").click(handleDeleteSheet);\r\n});\r\n\r\nfunction selectSheet(elem) {\r\n  emptyPreviousSheet();\r\n  selectedSheet = $(elem).text();\r\n  $(\".sheet-tab\").removeClass(\"selected\");\r\n  $(elem).addClass(\"selected\");\r\n  loadNewSheet();\r\n}\r\n\r\n$(\".sheet-tab\").click(function (e) {\r\n  if ($(this).text() != selectedSheet) {\r\n    selectSheet(this);\r\n  }\r\n});\r\n\r\nfunction emptyPreviousSheet() {\r\n  let rowKeys = Object.keys(sheets[selectedSheet]);\r\n  // console.log(\"rowkeys\", rowKeys);\r\n  for (let i of rowKeys) {\r\n    let colKeys = Object.keys(sheets[selectedSheet][i]);\r\n    for (let j of colKeys) {\r\n      let cell = $(`#row-${parseInt(i) + 1}-col-${parseInt(j) + 1}`);\r\n      // console.log(cell);\r\n      cell.text(\"\");\r\n      cell.css({\r\n        \"font-family\": \"Noto Sans\",\r\n        \"font-size\": 14,\r\n        \"font-weight\": 400,\r\n        \"font-style\": \"none\",\r\n        \"text-decoration\": \"none\",\r\n        \"text-align\": \"left\",\r\n        color: \"#444\",\r\n        \"background-color\": \"#fff\",\r\n      });\r\n    }\r\n  }\r\n}\r\n\r\nfunction loadNewSheet() {\r\n  let rowKeys = Object.keys(sheets[selectedSheet]);\r\n  for (let i of rowKeys) {\r\n    let colKeys = Object.keys(sheets[selectedSheet][i]);\r\n    for (let j of colKeys) {\r\n      let cell = $(`#row-${parseInt(i) + 1}-col-${parseInt(j) + 1}`);\r\n      cell.text(sheets[selectedSheet][i][j][\"text\"]);\r\n      cell.css({\r\n        \"font-family\": sheets[selectedSheet][i][j][\"font-family\"],\r\n        \"font-size\": sheets[selectedSheet][i][j][\"font-size\"],\r\n        \"font-weight\": sheets[selectedSheet][i][j][\"bold\"] ? \"bold\" : 400,\r\n        \"font-style\": sheets[selectedSheet][i][j][\"italic\"] ? \"italic\" : \"none\",\r\n        \"text-decoration\": sheets[selectedSheet][i][j][\"underlined\"]\r\n          ? \"underline\"\r\n          : \"none\",\r\n        \"text-align\": sheets[selectedSheet][i][j][\"alignment\"],\r\n        color: sheets[selectedSheet][i][j][\"color\"],\r\n        \"background-color\": sheets[selectedSheet][i][j][\"bgcolor\"],\r\n      });\r\n    }\r\n  }\r\n}\r\n\r\nfunction handleRenameSheet(e) {\r\n  let modal = $(`<div class=\"sheet-modal-parent\">\r\n  <div class=\"sheet-rename-modal\">\r\n      <div class=\"sheet-modal-title\">Rename Sheet</div>\r\n      <div class=\"sheet-modal-input-container\">\r\n          <span class=\"sheet-modal-input-title\">Rename Sheet to:</span>\r\n          <input class=\"sheet-modal-input\" type=\"text\" />\r\n      </div>\r\n      <div class=\"sheet-modal-confirmation\">\r\n          <div class=\"button yes-button\">OK</div>\r\n          <div class=\"button no-button\">Cancel</div>\r\n      </div>\r\n  </div>\r\n</div>`);\r\n  $(\".container\").append(modal);\r\n  $(\".no-button\").click(function (e) {\r\n    $(\".sheet-modal-parent\").remove();\r\n  });\r\n  $(\".yes-button\").click(() => {\r\n    let val = $(\".sheet-modal-input\").val();\r\n    if (val && !Object.keys(sheets).includes(val)) {\r\n      sheets[val] = { ...sheets[selectedSheet] };\r\n      let copySheets = {};\r\n      Object.keys(sheets).forEach((sheet) => {\r\n        if (sheet != selectedSheet) {\r\n          copySheets[sheet] = { ...sheets[sheet] };\r\n        } else {\r\n          copySheets[val] = { ...sheets[sheet] };\r\n        }\r\n      });\r\n      $(\".sheet-tab\").each((index, elem) => {\r\n        if ($(elem).text() === selectedSheet) {\r\n          $(elem).text(val);\r\n        }\r\n      });\r\n      sheets = { ...copySheets };\r\n      selectedSheet = val;\r\n      saved = false;\r\n    } else {\r\n      $(\".rename-error\").remove();\r\n      $(\".sheet-modal-input-container\").append(\r\n        `<div class=\"rename-error\">Sheet already exists or please enter a value</div>`\r\n      );\r\n    }\r\n    $(\".sheet-modal-parent\").remove();\r\n  });\r\n}\r\n\r\n$(\".container\").click(function (e) {\r\n  $(\".sheet-options-modal\").remove();\r\n});\r\n\r\nfunction handleDeleteSheet(e) {\r\n  let modal = $(`<div class=\"sheet-modal-parent\">\r\n  <div class=\"sheet-delete-modal\">\r\n      <div class=\"sheet-modal-title\">Sheet Name</div>\r\n      <div class=\"sheet-modal-detail-container\">\r\n          <span class=\"sheet-modal-detail-title\">Are you sure?</span>\r\n      </div>\r\n      <div class=\"sheet-modal-confirmation\">\r\n          <div class=\"button yes-button\">\r\n              <div class=\"material-icons delete-icon\">delete</div>\r\n              Delete\r\n          </div>\r\n          <div class=\"button no-button\">Cancel</div>\r\n      </div>\r\n  </div>\r\n</div>`);\r\n  $(\".container\").append(modal);\r\n  $(\".no-button\").click(function (e) {\r\n    $(\".sheet-modal-parent\").remove();\r\n  });\r\n  $(\".yes-button\").click(function (e) {\r\n    let keys = Object.keys(sheets);\r\n    let deletedSheet = selectedSheet;\r\n    keys.forEach((sheet, index) => {\r\n      console.log(\"deleted\", deletedSheet);\r\n      if (sheet === deletedSheet) {\r\n        console.log(\"index\", index);\r\n        if (index == keys.length - 1) {\r\n          selectSheet($(\".sheet-tab\")[0]);\r\n        } else {\r\n          selectSheet($(\".sheet-tab\")[index + 1]);\r\n        }\r\n        delete sheets[deletedSheet];\r\n      }\r\n    });\r\n    $(\".sheet-tab\").each((idx, elem) => {\r\n      if ($(elem).text() === deletedSheet) {\r\n        $(elem).remove();\r\n      }\r\n    });\r\n    $(\".sheet-modal-parent\").remove();\r\n    totalSheets--;\r\n    saved = false;\r\n  });\r\n}\r\n\r\n$(\".left-scroller\").click(function (e) {\r\n  let keys = Object.keys(sheets);\r\n  let index = keys.indexOf(selectedSheet);\r\n  if (index != 0) {\r\n    selectSheet($(\".sheet-tab\")[index - 1]);\r\n    $(\".sheet-tab\")[index - 1].scrollIntoView({ behaviour: \"smooth\" });\r\n  }\r\n});\r\n\r\n$(\".right-scroller\").click(function (e) {\r\n  let keys = Object.keys(sheets);\r\n  let index = keys.indexOf(selectedSheet);\r\n  if (index != keys.length - 1) {\r\n    selectSheet($(\".sheet-tab\")[index + 1]);\r\n    $(\".sheet-tab\")[index + 1].scrollIntoView({ behaviour: \"smooth\" });\r\n  }\r\n});\r\n\r\n$(\".menu-selector\").change(function (e) {\r\n  const value = $(this).val();\r\n  const id = $(this).attr(\"id\");\r\n  if (id == \"font-family\") {\r\n    $(\".input-cell.selected\").css(\"font-family\", value);\r\n    updateCellData(\"font-family\", value);\r\n  } else {\r\n    const num = parseInt(value);\r\n    $(\".input-cell.selected\").css(\"font-size\", num);\r\n    updateCellData(\"font-size\", num);\r\n  }\r\n});\r\n\r\nfunction updateCellData(property, value) {\r\n  let oldCellData = JSON.stringify(sheets);\r\n  if (value != defaultProperties[property]) {\r\n    $(\".input-cell.selected\").each((idx, data) => {\r\n      let [rowId, colId] = getRowColId(data);\r\n      if (sheets[selectedSheet][rowId - 1] == undefined) {\r\n        sheets[selectedSheet][rowId - 1] = {};\r\n        sheets[selectedSheet][rowId - 1][colId - 1] = {\r\n          ...defaultProperties,\r\n          upStream: [],\r\n          downStream: [],\r\n        };\r\n        sheets[selectedSheet][rowId - 1][colId - 1][property] = value;\r\n      } else {\r\n        if (sheets[selectedSheet][rowId - 1][colId - 1] == undefined) {\r\n          sheets[selectedSheet][rowId - 1][colId - 1] = {\r\n            ...defaultProperties,\r\n            upStream: [],\r\n            downStream: [],\r\n          };\r\n          sheets[selectedSheet][rowId - 1][colId - 1][property] = value;\r\n        } else {\r\n          sheets[selectedSheet][rowId - 1][colId - 1][property] = value;\r\n        }\r\n      }\r\n    });\r\n  } else {\r\n    $(\".input-cell.selected\").each((idx, data) => {\r\n      let [rowId, colId] = getRowColId(data);\r\n      if (\r\n        sheets[selectedSheet][rowId - 1] &&\r\n        sheets[selectedSheet][rowId - 1][colId - 1]\r\n      ) {\r\n        sheets[selectedSheet][rowId - 1][colId - 1][property] = value;\r\n        if (\r\n          JSON.stringify(sheets[selectedSheet][rowId - 1][colId - 1]) ==\r\n          JSON.stringify(defaultProperties)\r\n        ) {\r\n          delete sheets[selectedSheet][rowId - 1][colId - 1];\r\n          if (Object.keys(sheets[selectedSheet][rowId - 1]).length == 0)\r\n            delete sheets[selectedSheet][rowId - 1];\r\n        }\r\n      }\r\n    });\r\n  }\r\n  if (oldCellData !== JSON.stringify(sheets)) {\r\n    saved = false;\r\n  }\r\n}\r\n\r\n$(\"#menu-file\").click(function (e) {\r\n  const fileModal = $(` \r\n  <div class=\"file-modal-parent\">\r\n  <div class=\"file-modal\">\r\n  <div class=\"file-options-modal\">\r\n      <div class=\"close\">\r\n          <div class=\"material-icons close-icon\">arrow_circle_down</div>\r\n          <div>Close</div>\r\n      </div>\r\n      <div class=\"new\">\r\n          <div class=\"material-icons new-icon\">insert_drive_file</div>\r\n          <div>New</div>\r\n      </div>\r\n      <div class=\"open\">\r\n          <div class=\"material-icons open-icon\">folder_open</div>\r\n          <div>Open</div>\r\n      </div>\r\n      <div class=\"save\">\r\n          <div class=\"material-icons save-icon\">save</div>\r\n          <div>Save</div>\r\n      </div>\r\n  </div>\r\n  <div class=\"file-recent-modal\"></div>\r\n</div></div>`);\r\n  $(\".container\").append(fileModal);\r\n  $(\".close\").click(function (e) {\r\n    console.log(\"clicked\");\r\n    $(\".file-modal-parent\").remove();\r\n  });\r\n\r\n  $(\".file-modal-parent\").click(function (e) {\r\n    $(this).remove();\r\n  });\r\n\r\n  $(\".file-modal\").click(function (e) {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    e.stopImmediatePropagation();\r\n  });\r\n\r\n  $(\".open\").click(function (e) {\r\n    openFile();\r\n    $(\".file-modal-parent\").remove();\r\n  });\r\n\r\n  $(\".new\").click(function (e) {\r\n    $(\".file-modal-parent\").remove();\r\n    if (!saved) {\r\n      const sureModal = $(`<div class=\"sheet-modal-parent\">\r\n       <div class=\"sheet-delete-modal\">\r\n           <div class=\"sheet-modal-title\">${$(\".title\").text()}</div>\r\n           <div class=\"sheet-modal-detail-container\">\r\n               <span class=\"sheet-modal-detail-title\">Do you want to save the unsaved changes?</span>\r\n           </div>\r\n           <div class=\"sheet-modal-confirmation\">\r\n               <div class=\"button yes-button\">\r\n                   Yes\r\n               </div>\r\n               <div class=\"button no-button\">No</div>\r\n           </div>\r\n       </div>\r\n     </div>`);\r\n      $(\".container\").append(sureModal);\r\n      $(\".yes-button\").click(function (e) {\r\n        $(\".sheet-modal-parent\").remove();\r\n        saveFile(true);\r\n      });\r\n      $(\".no-button\").click(function (e) {\r\n        $(\".sheet-modal-parent\").remove();\r\n        openNewFile();\r\n      });\r\n    } else {\r\n      openNewFile();\r\n    }\r\n  });\r\n\r\n  $(\".save\").click(function (e) {\r\n    $(\".file-modal-parent\").remove();\r\n    saveFile();\r\n  });\r\n});\r\n\r\nfunction openNewFile() {\r\n  emptyPreviousSheet();\r\n  selectedSheet = \"Sheet1\";\r\n  sheets = { Sheet1: {} };\r\n  totalSheets = 1;\r\n  lastSheetAdded = 1;\r\n  $(\".sheet-tab\").remove();\r\n  $(\".sheet-tab-container\").append(\r\n    `<div class=\"sheet-tab selected\">Sheet1</div>`\r\n  );\r\n  $(\".title\").text(\"Excel-Book\");\r\n  $(\"#row-1-col-1\").click();\r\n}\r\n\r\nfunction saveFile(newClicked) {\r\n  const saveModal = $(`<div class=\"sheet-modal-parent\">\r\n    <div class=\"sheet-rename-modal\">\r\n        <div class=\"sheet-modal-title\">Save File</div>\r\n        <div class=\"sheet-modal-input-container\">\r\n            <span class=\"sheet-modal-input-title\">Enter File Name:</span>\r\n            <input class=\"sheet-modal-input\" type=\"text\" />\r\n        </div>\r\n        <div class=\"sheet-modal-confirmation\">\r\n            <div class=\"button yes-button\">OK</div>\r\n            <div class=\"button no-button\">Cancel</div>\r\n        </div>\r\n    </div>\r\n  </div>`);\r\n  $(\".container\").append(saveModal);\r\n  $(\".no-button\").click(function (e) {\r\n    $(\".sheet-modal-parent\").remove();\r\n  });\r\n  $(\".yes-button\").click(function (e) {\r\n    $(\".title\").text($(\".sheet-modal-input\").val());\r\n    let a = document.createElement(\"a\");\r\n    a.href = `data:application/json,${encodeURIComponent(\r\n      JSON.stringify(sheets)\r\n    )}`;\r\n    console.log(a);\r\n    a.download = $(\".title\").text() + \".json\";\r\n    $(\".container\").append(a);\r\n    a.click();\r\n    a.remove();\r\n    saved = true;\r\n    $(\".sheet-modal-parent\").remove();\r\n    if (newClicked) {\r\n      openNewFile();\r\n    }\r\n  });\r\n}\r\n\r\nfunction openFile() {\r\n  let inputFile = $(`<input accept=\"application/json\" type=\"file\" />`);\r\n  $(\".container\").append(inputFile);\r\n  inputFile.click();\r\n  inputFile.change(function (e) {\r\n    let file = e.target.files[0];\r\n    $(\".title\").text(file.name.split(\".json\")[0]);\r\n    let reader = new FileReader();\r\n    reader.readAsText(file);\r\n    reader.onload = () => {\r\n      emptyPreviousSheet();\r\n      $(\".sheet-tab\").remove();\r\n      sheets = JSON.parse(reader.result);\r\n      console.log(sheets);\r\n      let keys = Object.keys(sheets);\r\n      lastlyAddedSheet = 1;\r\n      for (let i of keys) {\r\n        if (i.includes(\"Sheet\")) {\r\n          let splittedSheetArray = i.split(\"Sheet\");\r\n          if (splittedSheetArray.length == 2 && !isNaN(splittedSheetArray[1])) {\r\n            lastlyAddedSheet = parseInt(splittedSheetArray[1]);\r\n          }\r\n        }\r\n        $(\".sheet-tab-container\").append(\r\n          `<div class=\"sheet-tab selected\">${i}</div>`\r\n        );\r\n      }\r\n      addSheetListeners();\r\n      $(\".sheet-tab\").removeClass(\"selected\");\r\n      $($(\".sheet-tab\")[0]).addClass(\"selected\");\r\n      selectedSheet = keys[0];\r\n      totalSheets = keys.length;\r\n      loadNewSheet();\r\n      inputFile.remove();\r\n    };\r\n  });\r\n}\r\nlet clipBoard;\r\nlet contentCutted;\r\n$(\".copy,.cut\").click(function (e) {\r\n  if ($(this).text() === \"content_cut\") contentCutted = true;\r\n  clipBoard = { startCell: [], cellData: {} };\r\n  clipBoard.startCell = getRowColId($(\".input-cell.selected\")[0]);\r\n  let { cellData } = clipBoard;\r\n  $(\".input-cell.selected\").each((idx, elem) => {\r\n    let [row, col] = getRowColId(elem);\r\n    if (\r\n      sheets[selectedSheet][row - 1] &&\r\n      sheets[selectedSheet][row - 1][col - 1]\r\n    ) {\r\n      if (!cellData[row]) {\r\n        cellData[row] = {};\r\n      }\r\n      cellData[row][col] = { ...sheets[selectedSheet][row - 1][col - 1] };\r\n      if (contentCutted) {\r\n        delete sheets[selectedSheet][row - 1][col - 1];\r\n        if (Object.keys(sheets[selectedSheet][row - 1]).length == 0)\r\n          delete sheets[selectedSheet][row - 1];\r\n        let cell = $(`#row-${parseInt(row)}-col-${parseInt(col)}`);\r\n        cell.text(\"\");\r\n        cell.css({\r\n          \"font-family\": \"Noto Sans\",\r\n          \"font-size\": 14,\r\n          \"font-weight\": 400,\r\n          \"font-style\": \"none\",\r\n          \"text-decoration\": \"none\",\r\n          \"text-align\": \"left\",\r\n          color: \"#444\",\r\n          \"background-color\": \"#fff\",\r\n        });\r\n      }\r\n    }\r\n  });\r\n  console.log(clipBoard);\r\n});\r\n\r\n$(\".paste\").click(function (e) {\r\n  let sCell = getRowColId($(\".input-cell.selected\")[0]);\r\n  let { cellData } = clipBoard;\r\n  let rows = Object.keys(cellData);\r\n  console.log(rows);\r\n  for (i of rows) {\r\n    let cols = Object.keys(cellData[i]);\r\n    for (j of cols) {\r\n      let rowDiff = parseInt(i) - clipBoard.startCell[0];\r\n      let colDiff = parseInt(j) - clipBoard.startCell[1];\r\n      if (!sheets[selectedSheet][sCell[0] + rowDiff - 1]) {\r\n        sheets[selectedSheet][sCell[0] + rowDiff - 1] = {};\r\n      }\r\n      sheets[selectedSheet][sCell[0] + rowDiff - 1][sCell[1] + colDiff - 1] =\r\n        cellData[i][j];\r\n    }\r\n  }\r\n  loadNewSheet();\r\n  if (contentCutted) {\r\n    contentCutted = false;\r\n    clipBoard = { startCell: [], cellData: {} };\r\n  }\r\n});\r\n\r\n$(\"#formula-input\").blur(function (e) {\r\n  if ($(\".input-cell.selected\").length > 0) {\r\n    let formula = $(this).text();\r\n    // console.log($(this).val());\r\n    let splitArr = formula.split(\" \");\r\n    let elements = [];\r\n    for (let i of splitArr) {\r\n      if (i.length >= 2) {\r\n        i = i.replace(\"(\", \"\");\r\n        i = i.replace(\")\", \"\");\r\n        elements.push(i);\r\n      }\r\n    }\r\n    $(\".input-cell.selected\").each((index, elem) => {\r\n      if (updateStream(elem, elements)) {\r\n        console.log(\"passed\");\r\n      } else {\r\n        console.log(\"not\");\r\n      }\r\n    });\r\n    console.log(elements);\r\n  } else {\r\n    alert(\"!Please select a cell to apply the formula\");\r\n  }\r\n});\r\n\r\nfunction updateStream(elem, elements) {\r\n  let [rowId, colId] = getRowColId(elem);\r\n  let selfCode = $(`.column-${colId}`).attr(\"id\") + rowId;\r\n  if (elements.includes(selfCode)) {\r\n    return false;\r\n  }\r\n  return true;\r\n}\r\n"]}