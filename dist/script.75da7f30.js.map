{"version":3,"sources":["script.js","node_modules/parcel-bundler/src/builtins/hmr-runtime.js"],"names":["ps","PerfectScrollbar","wheelSpeed","wheelPropagation","defaultProperties","text","bold","italic","underlined","alignment","color","bgcolor","formula","upStream","downStream","i","str","n","rem","Math","floor","String","fromCharCode","$","append","cellData","sheets","Sheet1","saved","selectedSheet","totalSheets","lastSheetAdded","sheetSelectedForSomeAction","row","j","getRowColId","elem","classArr","attr","split","rowId","parseInt","colId","grabAdjacentCells","topCell","bottomCell","leftCell","rightCell","on","e","console","log","hasClass","ctrlKey","unselectCells","selectCell","dblclick","focus","blur","updateCellData","getSelectedBooleans","topSelected","rightSelected","bottomSelected","leftSelected","cell","addClass","removeClass","changeHeader","startCellSelected","startCell","endCell","mousemove","preventDefault","buttons","mouseenter","selectBetweenCell","start","end","min","max","data","rest","setHeaderStyle","css","val","id","property","click","align","toggleClass","scroll","scrollLeft","scrollTop","colorPick","initialColor","allowRecent","recentMax","allowCustomColor","palette","onColorSelected","element","children","addSheetListeners","emptyPreviousSheet","scrollIntoView","behaviour","loadNewSheet","selectSheet","remove","left","pageX","handleRenameSheet","handleDeleteSheet","rowKeys","Object","keys","colKeys","modal","includes","copySheets","forEach","sheet","each","index","deletedSheet","length","idx","indexOf","change","value","num","oldCellData","JSON","stringify","undefined","fileModal","stopPropagation","stopImmediatePropagation","openFile","sureModal","saveFile","openNewFile","newClicked","saveModal","a","document","createElement","href","encodeURIComponent","download","inputFile","file","target","files","name","reader","FileReader","readAsText","onload","parse","result","lastlyAddedSheet","splittedSheetArray","isNaN","clipBoard","contentCutted","col","sCell","rows","cols","rowDiff","colDiff","splitArr","elements","replace","push","updateStream","alert","selfCode","OVERLAY_ID","OldModule","module","bundle","Module","moduleName","call","hot","hotData","_acceptCallbacks","_disposeCallbacks","accept","fn","dispose","checkedAssets","assetsToAccept","parent","isParcelRequire","WebSocket","hostname","location","protocol","ws","onmessage","event","type","handled","assets","asset","isNew","didAccept","hmrAcceptCheck","global","parcelRequire","every","generated","js","clear","hmrApply","v","hmrAcceptRun","reload","close","onclose","removeErrorOverlay","error","message","stack","overlay","createErrorOverlay","body","appendChild","getElementById","stackTrace","innerText","innerHTML","getParents","modules","parents","k","d","dep","Array","isArray","concat","Function","deps","cached","cache","some","cb"],"mappings":"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","file":"script.75da7f30.js","sourceRoot":"..","sourcesContent":["const ps = new PerfectScrollbar(\"#cells\", {\r\n  wheelSpeed: 10,\r\n  wheelPropagation: true,\r\n});\r\n\r\nlet defaultProperties = {\r\n  \"font-family\": \"Noto Sans\",\r\n  \"font-size\": 14,\r\n  text: \"\",\r\n  bold: false,\r\n  italic: false,\r\n  underlined: false,\r\n  alignment: \"left\",\r\n  color: \"#444\",\r\n  bgcolor: \"#fff\",\r\n  formula: \"\",\r\n  upStream: [],\r\n  downStream: [],\r\n};\r\n\r\nfor (let i = 1; i <= 100; i++) {\r\n  let str = \"\";\r\n  let n = i;\r\n\r\n  while (n > 0) {\r\n    let rem = n % 26;\r\n    if (rem == 0) {\r\n      str = \"Z\" + str;\r\n      n = Math.floor(n / 26) - 1;\r\n    } else {\r\n      str = String.fromCharCode(rem - 1 + 65) + str;\r\n      n = Math.floor(n / 26);\r\n    }\r\n  }\r\n  $(\"#columns\").append(\r\n    `<div class=\"column-name column-${i}\" id=\"${str}\">${str}</div>`\r\n  );\r\n  $(\"#rows\").append(`<div class=\"row-name ${i}\">${i}</div>`);\r\n}\r\nlet cellData = [];\r\nlet sheets = {\r\n  Sheet1: {},\r\n};\r\nlet saved = true;\r\nlet selectedSheet = \"Sheet1\";\r\nlet totalSheets = 1;\r\nlet lastSheetAdded = 1;\r\nlet sheetSelectedForSomeAction;\r\nfor (let i = 1; i <= 100; i++) {\r\n  let row = $('<div class=\"cell-row\"></div>');\r\n  // let rowData = [];\r\n  for (let j = 1; j <= 100; j++) {\r\n    row.append(\r\n      `<div id=\"row-${i}-col-${j}\" class=\"input-cell\" contenteditable=\"false\"></div>`\r\n    );\r\n    // rowData.push({ ...defaultProperties });\r\n  }\r\n  $(\"#cells\").append(row);\r\n  // cellData.push(rowData);\r\n}\r\n\r\nfunction getRowColId(elem) {\r\n  const classArr = $(elem).attr(\"id\").split(\"-\");\r\n  const rowId = parseInt(classArr[1]);\r\n  const colId = parseInt(classArr[3]);\r\n  return [rowId, colId];\r\n}\r\n\r\nfunction grabAdjacentCells(elem) {\r\n  const classArr = $(elem).attr(\"id\").split(\"-\");\r\n  const rowId = parseInt(classArr[1]);\r\n  const colId = parseInt(classArr[3]);\r\n  // console.log(cellData[rowId - 1][colId - 1]);\r\n  let topCell = $(`#row-${rowId - 1}-col-${colId}`);\r\n  let bottomCell = $(`#row-${rowId + 1}-col-${colId}`);\r\n  let leftCell = $(`#row-${rowId}-col-${colId - 1}`);\r\n  let rightCell = $(`#row-${rowId}-col-${colId + 1}`);\r\n  return [topCell, rightCell, bottomCell, leftCell];\r\n}\r\n\r\n$(\".input-cell\").on(\"click\", function (e) {\r\n  // console.log($(this));\r\n  console.log(sheets);\r\n  const [topCell, rightCell, bottomCell, leftCell] = grabAdjacentCells(this);\r\n  // console.log(topCell.length);\r\n  // if (topCell.length) console.log(\"topcell exists\");\r\n  if ($(this).hasClass(\"selected\") && e.ctrlKey) {\r\n    // unselectCell(this, e, topCell, bottomCell, leftCell, rightCell);\r\n    return unselectCells(this, topCell, rightCell, bottomCell, leftCell);\r\n  } else {\r\n    selectCell(e, this, topCell, rightCell, bottomCell, leftCell);\r\n  }\r\n  // const [rowId, colId] = getRowColId(this);\r\n  // console.log(cellData[rowId - 1][colId - 1]);\r\n});\r\n\r\n$(\".input-cell\").dblclick(function (e) {\r\n  $(this).attr(\"contenteditable\", true);\r\n  $(this).focus();\r\n});\r\n\r\n$(\".input-cell\").blur(function (e) {\r\n  $(this).attr(\"contenteditable\", false);\r\n  updateCellData(\"text\", $(this).text());\r\n});\r\n\r\nfunction getSelectedBooleans(topCell, rightCell, bottomCell, leftCell) {\r\n  let topSelected, rightSelected, bottomSelected, leftSelected;\r\n  // console.log(e.ctrlKey);\r\n\r\n  if (topCell) {\r\n    topSelected = topCell.hasClass(\"selected\");\r\n  }\r\n\r\n  if (bottomCell) {\r\n    bottomSelected = bottomCell.hasClass(\"selected\");\r\n  }\r\n\r\n  if (rightCell) {\r\n    rightSelected = rightCell.hasClass(\"selected\");\r\n  }\r\n\r\n  if (leftCell) {\r\n    leftSelected = leftCell.hasClass(\"selected\");\r\n  }\r\n\r\n  return [topSelected, rightSelected, bottomSelected, leftSelected];\r\n}\r\n\r\nfunction selectCell(e, cell, topCell, rightCell, bottomCell, leftCell) {\r\n  if (e.ctrlKey) {\r\n    // if ($(cell).hasClass(\"selected\")) {\r\n    //   return unselectCells(cell, topCell, rightCell, bottomCell, leftCell);\r\n    // }\r\n\r\n    const [topSelected, rightSelected, bottomSelected, leftSelected] =\r\n      getSelectedBooleans(topCell, rightCell, bottomCell, leftCell);\r\n\r\n    if (topSelected) {\r\n      $(cell).addClass(\"top-selected\");\r\n      topCell.addClass(\"bottom-selected\");\r\n    }\r\n\r\n    if (rightSelected) {\r\n      $(cell).addClass(\"right-selected\");\r\n      rightCell.addClass(\"left-selected\");\r\n    }\r\n\r\n    if (bottomSelected) {\r\n      $(cell).addClass(\"bottom-selected\");\r\n      bottomCell.addClass(\"top-selected\");\r\n    }\r\n\r\n    if (leftSelected) {\r\n      $(cell).addClass(\"left-selected\");\r\n      leftCell.addClass(\"right-selected\");\r\n    }\r\n  } else {\r\n    $(\".input-cell.selected\").removeClass(\r\n      \"selected top-selected bottom-selected left-selected right-selected\"\r\n    );\r\n  }\r\n  $(cell).addClass(\"selected\");\r\n  changeHeader(getRowColId(cell));\r\n}\r\n\r\nfunction unselectCells(cell, topCell, rightCell, bottomCell, leftCell) {\r\n  const [topSelected, rightSelected, bottomSelected, leftSelected] =\r\n    getSelectedBooleans(topCell, rightCell, bottomCell, leftCell);\r\n  if (topSelected) {\r\n    topCell.removeClass(\"bottom-selected\");\r\n    $(cell).removeClass(\"top-selected\");\r\n  }\r\n\r\n  if (rightSelected) {\r\n    rightCell.removeClass(\"left-selected\");\r\n    $(cell).removeClass(\"right-selected\");\r\n  }\r\n\r\n  if (bottomSelected) {\r\n    bottomCell.removeClass(\"top-selected\");\r\n    $(cell).removeClass(\"bottom-selected\");\r\n  }\r\n\r\n  if (leftSelected) {\r\n    leftCell.removeClass(\"right-selected\");\r\n    $(cell).removeClass(\"left-selected\");\r\n  }\r\n\r\n  $(cell).removeClass(\"selected\");\r\n  $(cell).blur();\r\n}\r\nlet startCellSelected = false;\r\nlet startCell = {};\r\nlet endCell = {};\r\n$(\".input-cell\").mousemove(function (e) {\r\n  e.preventDefault();\r\n  if (e.buttons == 1) {\r\n    if (!startCellSelected) {\r\n      startCellSelected = true;\r\n      let [rowId, colId] = getRowColId(this);\r\n      startCell = { rowId, colId };\r\n      // console.log(\"sc \", startCell);\r\n      //\r\n    }\r\n  } else {\r\n    startCellSelected = false;\r\n  }\r\n});\r\n\r\n$(\".input-cell\").mouseenter(function (e) {\r\n  if (e.buttons == 1) {\r\n    let [rowId, colId] = getRowColId(this);\r\n    endCell = { rowId, colId };\r\n    // console.log(\"ec\", endCell);\r\n    selectBetweenCell(startCell, endCell);\r\n  }\r\n});\r\n\r\nfunction selectBetweenCell(start, end) {\r\n  $(\".input-cell.selected\").removeClass(\r\n    \"selected top-selected bottom-selected left-selected right-selected\"\r\n  );\r\n  // console.log(start, end);\r\n  for (\r\n    let i = Math.min(start.rowId, end.rowId);\r\n    i <= Math.max(start.rowId, end.rowId);\r\n    i++\r\n  ) {\r\n    for (\r\n      let j = Math.min(start.colId, end.colId);\r\n      j <= Math.max(start.colId, end.colId);\r\n      j++\r\n    ) {\r\n      const cell = $(`#row-${i}-col-${j}`)[0];\r\n      const [topCell, rightCell, bottomCell, leftCell] =\r\n        grabAdjacentCells(cell);\r\n\r\n      selectCell(\r\n        { ctrlKey: true },\r\n        cell,\r\n        topCell,\r\n        rightCell,\r\n        bottomCell,\r\n        leftCell\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nfunction changeHeader([rowId, colId]) {\r\n  if (\r\n    sheets[selectedSheet][rowId - 1] &&\r\n    sheets[selectedSheet][rowId - 1][colId - 1]\r\n  ) {\r\n    const {\r\n      alignment: data,\r\n      bold,\r\n      italic,\r\n      underlined,\r\n      ...rest\r\n    } = sheets[selectedSheet][rowId - 1][colId - 1];\r\n    $(\".alignment\").removeClass(\"selected\");\r\n    $(`.alignment[data-type=${data}]`).addClass(\"selected\");\r\n    setHeaderStyle(\"#bold\", bold);\r\n    setHeaderStyle(\"#italic\", italic);\r\n    setHeaderStyle(\"#underlined\", underlined);\r\n    $(\"#fill-color\").css(\"border-color\", rest.bgcolor);\r\n    $(\"#text-color\").css(\"border-color\", rest.color);\r\n    $(\"#font-family\").val(rest[\"font-family\"]);\r\n    $(\"#font-size\").val(rest[\"font-size\"]);\r\n    $(\"#font-family\").css(\"font-family\", rest[\"font-family\"]);\r\n  } else {\r\n    $(\".alignment\").removeClass(\"selected\");\r\n    $(`.alignment[data-type=left]`).addClass(\"selected\");\r\n    setHeaderStyle(\"#bold\", defaultProperties[\"bold\"]);\r\n    setHeaderStyle(\"#italic\", defaultProperties[\"italic\"]);\r\n    setHeaderStyle(\"#underlined\", defaultProperties[\"underlined\"]);\r\n    $(\"#fill-color\").css(\"border-color\", defaultProperties[\"bgcolor\"]);\r\n    $(\"#text-color\").css(\"border-color\", defaultProperties[\"color\"]);\r\n    $(\"#font-family\").val(defaultProperties[\"font-family\"]);\r\n    $(\"#font-size\").val(defaultProperties[\"font-size\"]);\r\n    $(\"#font-family\").css(\"font-family\", defaultProperties[\"font-family\"]);\r\n  }\r\n}\r\n\r\nfunction setHeaderStyle(id, property) {\r\n  if (property) $(id).addClass(\"selected\");\r\n  else $(id).removeClass(\"selected\");\r\n}\r\n\r\n$(`.alignment`).click(function (e) {\r\n  $(\".alignment\").removeClass(\"selected\");\r\n  $(this).addClass(\"selected\");\r\n  let align = $(this).attr(\"data-type\");\r\n  $(\".input-cell.selected\").css(\"text-align\", align);\r\n  updateCellData(\"alignment\", align);\r\n});\r\n\r\n$(\"#bold\").click(function (e) {\r\n  if (!$(this).hasClass(\"selected\")) {\r\n    $(\".input-cell.selected\").css(\"font-weight\", \"bold\");\r\n    updateCellData(\"bold\", true);\r\n  } else {\r\n    $(\".input-cell.selected\").css(\"font-weight\", 400);\r\n    updateCellData(\"bold\", false);\r\n  }\r\n  $(this).toggleClass(\"selected\");\r\n});\r\n\r\n$(\"#italic\").click(function (e) {\r\n  if (!$(this).hasClass(\"selected\")) {\r\n    $(\".input-cell.selected\").css(\"font-style\", \"italic\");\r\n    updateCellData(\"italic\", true);\r\n  } else {\r\n    $(\".input-cell.selected\").css(\"font-style\", \"normal\");\r\n    updateCellData(\"italic\", false);\r\n  }\r\n  $(this).toggleClass(\"selected\");\r\n});\r\n\r\n$(\"#underlined\").click(function (e) {\r\n  if (!$(this).hasClass(\"selected\")) {\r\n    $(\".input-cell.selected\").css(\"text-decoration\", \"underline\");\r\n    updateCellData(\"underlined\", true);\r\n  } else {\r\n    $(\".input-cell.selected\").css(\"text-decoration\", \"none\");\r\n    updateCellData(\"underlined\", false);\r\n  }\r\n  $(this).toggleClass(\"selected\");\r\n});\r\n\r\n$(\"#cells\").scroll(function (e) {\r\n  $(\"#columns\").scrollLeft(this.scrollLeft);\r\n  $(\"#rows\").scrollTop(this.scrollTop);\r\n});\r\n// $(\".pick-color\").click(() => console.log(\"cliecked\"));\r\n$(\".pick-color\").colorPick({\r\n  initialColor: \"#abcd\",\r\n  allowRecent: true,\r\n  recentMax: 5,\r\n  allowCustomColor: false,\r\n  palette: [\r\n    \"#1abc9c\",\r\n    \"#16a085\",\r\n    \"#2ecc71\",\r\n    \"#27ae60\",\r\n    \"#3498db\",\r\n    \"#2980b9\",\r\n    \"#9b59b6\",\r\n    \"#8e44ad\",\r\n    \"#34495e\",\r\n    \"#2c3e50\",\r\n    \"#f1c40f\",\r\n    \"#f39c12\",\r\n    \"#e67e22\",\r\n    \"#d35400\",\r\n    \"#e74c3c\",\r\n    \"#c0392b\",\r\n    \"#ecf0f1\",\r\n    \"#bdc3c7\",\r\n    \"#95a5a6\",\r\n    \"#7f8c8d\",\r\n  ],\r\n  onColorSelected: function () {\r\n    // this.element.css({ backgroundColor: this.color, color: this.color });\r\n    if (this.color != \"#ABCD\") {\r\n      const id = $(this.element.children()[1]).attr(\"id\");\r\n      // console.log(id);\r\n      $(this.element.children()[1]).css(\"border-color\", this.color);\r\n      if (id == \"fill-color\") {\r\n        $(\".input-cell.selected\").css(\"background-color\", this.color);\r\n        updateCellData(\"bgcolor\", this.color);\r\n      } else {\r\n        $(\".input-cell.selected\").css(\"color\", this.color);\r\n        updateCellData(\"color\", this.color);\r\n      }\r\n    }\r\n\r\n    // console.log(this.element.children()[0]);\r\n  },\r\n});\r\n\r\n$(\".add-sheet\").click(function (e) {\r\n  totalSheets++;\r\n  lastSheetAdded++;\r\n  $(\".sheet-tab\").removeClass(\"selected\");\r\n  $(\".sheet-tab-container\").append(\r\n    `<div class=\"sheet-tab selected\">Sheet${lastSheetAdded}</div>`\r\n  );\r\n  sheets[$(\".sheet-tab.selected\").text()] = {};\r\n  addSheetListeners();\r\n  emptyPreviousSheet();\r\n  selectedSheet = $(\".sheet-tab.selected\").text();\r\n  $(\".sheet-tab.selected\")[0].scrollIntoView({ behaviour: \"smooth\" });\r\n  saved = false;\r\n});\r\n\r\nfunction addSheetListeners() {\r\n  $(\".sheet-tab.selected\").click(function (e) {\r\n    if ($(this).text() != selectedSheet) {\r\n      $(\".sheet-tab\").removeClass(\"selected\");\r\n      $(this).addClass(\"selected\");\r\n      emptyPreviousSheet();\r\n      selectedSheet = $(this).text();\r\n      $(\".sheet-tab\").removeClass(\"selected\");\r\n      $(this).addClass(\"selected\");\r\n      loadNewSheet();\r\n    }\r\n  });\r\n  $(\".sheet-tab.selected\").on(\"contextmenu\", function (e) {\r\n    e.preventDefault();\r\n    selectSheet(this);\r\n    $(\".sheet-options-modal\").remove();\r\n    $(\".container\").append(`<div class=\"sheet-options-modal\">\r\n    <div class=\"option sheet-rename\">Rename</div>\r\n    <div class=\"option sheet-delete\">Delete</div>\r\n  </div>`);\r\n    $(\".sheet-options-modal\").css({\r\n      left: e.pageX,\r\n    });\r\n    $(\".sheet-rename\").click(handleRenameSheet);\r\n    $(\".sheet-delete\").click(handleDeleteSheet);\r\n  });\r\n}\r\n\r\n$(\".sheet-tab\").on(\"contextmenu\", function (e) {\r\n  e.preventDefault();\r\n  console.log(\"clicked context\");\r\n  selectSheet(this);\r\n  $(\".sheet-options-modal\").remove();\r\n  $(\".container\").append(`<div class=\"sheet-options-modal\">\r\n  <div class=\"option sheet-rename\">Rename</div>\r\n  <div class=\"option sheet-delete\">Delete</div>\r\n</div>`);\r\n  $(\".sheet-options-modal\").css({\r\n    left: e.pageX,\r\n  });\r\n  $(\".sheet-rename\").click(handleRenameSheet);\r\n  $(\".sheet-delete\").click(handleDeleteSheet);\r\n});\r\n\r\nfunction selectSheet(elem) {\r\n  emptyPreviousSheet();\r\n  selectedSheet = $(elem).text();\r\n  $(\".sheet-tab\").removeClass(\"selected\");\r\n  $(elem).addClass(\"selected\");\r\n  loadNewSheet();\r\n}\r\n\r\n$(\".sheet-tab\").click(function (e) {\r\n  if ($(this).text() != selectedSheet) {\r\n    selectSheet(this);\r\n  }\r\n});\r\n\r\nfunction emptyPreviousSheet() {\r\n  let rowKeys = Object.keys(sheets[selectedSheet]);\r\n  // console.log(\"rowkeys\", rowKeys);\r\n  for (let i of rowKeys) {\r\n    let colKeys = Object.keys(sheets[selectedSheet][i]);\r\n    for (let j of colKeys) {\r\n      let cell = $(`#row-${parseInt(i) + 1}-col-${parseInt(j) + 1}`);\r\n      // console.log(cell);\r\n      cell.text(\"\");\r\n      cell.css({\r\n        \"font-family\": \"Noto Sans\",\r\n        \"font-size\": 14,\r\n        \"font-weight\": 400,\r\n        \"font-style\": \"none\",\r\n        \"text-decoration\": \"none\",\r\n        \"text-align\": \"left\",\r\n        color: \"#444\",\r\n        \"background-color\": \"#fff\",\r\n      });\r\n    }\r\n  }\r\n}\r\n\r\nfunction loadNewSheet() {\r\n  let rowKeys = Object.keys(sheets[selectedSheet]);\r\n  for (let i of rowKeys) {\r\n    let colKeys = Object.keys(sheets[selectedSheet][i]);\r\n    for (let j of colKeys) {\r\n      let cell = $(`#row-${parseInt(i) + 1}-col-${parseInt(j) + 1}`);\r\n      cell.text(sheets[selectedSheet][i][j][\"text\"]);\r\n      cell.css({\r\n        \"font-family\": sheets[selectedSheet][i][j][\"font-family\"],\r\n        \"font-size\": sheets[selectedSheet][i][j][\"font-size\"],\r\n        \"font-weight\": sheets[selectedSheet][i][j][\"bold\"] ? \"bold\" : 400,\r\n        \"font-style\": sheets[selectedSheet][i][j][\"italic\"] ? \"italic\" : \"none\",\r\n        \"text-decoration\": sheets[selectedSheet][i][j][\"underlined\"]\r\n          ? \"underline\"\r\n          : \"none\",\r\n        \"text-align\": sheets[selectedSheet][i][j][\"alignment\"],\r\n        color: sheets[selectedSheet][i][j][\"color\"],\r\n        \"background-color\": sheets[selectedSheet][i][j][\"bgcolor\"],\r\n      });\r\n    }\r\n  }\r\n}\r\n\r\nfunction handleRenameSheet(e) {\r\n  let modal = $(`<div class=\"sheet-modal-parent\">\r\n  <div class=\"sheet-rename-modal\">\r\n      <div class=\"sheet-modal-title\">Rename Sheet</div>\r\n      <div class=\"sheet-modal-input-container\">\r\n          <span class=\"sheet-modal-input-title\">Rename Sheet to:</span>\r\n          <input class=\"sheet-modal-input\" type=\"text\" />\r\n      </div>\r\n      <div class=\"sheet-modal-confirmation\">\r\n          <div class=\"button yes-button\">OK</div>\r\n          <div class=\"button no-button\">Cancel</div>\r\n      </div>\r\n  </div>\r\n</div>`);\r\n  $(\".container\").append(modal);\r\n  $(\".no-button\").click(function (e) {\r\n    $(\".sheet-modal-parent\").remove();\r\n  });\r\n  $(\".yes-button\").click(() => {\r\n    let val = $(\".sheet-modal-input\").val();\r\n    if (val && !Object.keys(sheets).includes(val)) {\r\n      sheets[val] = { ...sheets[selectedSheet] };\r\n      let copySheets = {};\r\n      Object.keys(sheets).forEach((sheet) => {\r\n        if (sheet != selectedSheet) {\r\n          copySheets[sheet] = { ...sheets[sheet] };\r\n        } else {\r\n          copySheets[val] = { ...sheets[sheet] };\r\n        }\r\n      });\r\n      $(\".sheet-tab\").each((index, elem) => {\r\n        if ($(elem).text() === selectedSheet) {\r\n          $(elem).text(val);\r\n        }\r\n      });\r\n      sheets = { ...copySheets };\r\n      selectedSheet = val;\r\n      saved = false;\r\n    } else {\r\n      $(\".rename-error\").remove();\r\n      $(\".sheet-modal-input-container\").append(\r\n        `<div class=\"rename-error\">Sheet already exists or please enter a value</div>`\r\n      );\r\n    }\r\n    $(\".sheet-modal-parent\").remove();\r\n  });\r\n}\r\n\r\n$(\".container\").click(function (e) {\r\n  $(\".sheet-options-modal\").remove();\r\n});\r\n\r\nfunction handleDeleteSheet(e) {\r\n  let modal = $(`<div class=\"sheet-modal-parent\">\r\n  <div class=\"sheet-delete-modal\">\r\n      <div class=\"sheet-modal-title\">Sheet Name</div>\r\n      <div class=\"sheet-modal-detail-container\">\r\n          <span class=\"sheet-modal-detail-title\">Are you sure?</span>\r\n      </div>\r\n      <div class=\"sheet-modal-confirmation\">\r\n          <div class=\"button yes-button\">\r\n              <div class=\"material-icons delete-icon\">delete</div>\r\n              Delete\r\n          </div>\r\n          <div class=\"button no-button\">Cancel</div>\r\n      </div>\r\n  </div>\r\n</div>`);\r\n  $(\".container\").append(modal);\r\n  $(\".no-button\").click(function (e) {\r\n    $(\".sheet-modal-parent\").remove();\r\n  });\r\n  $(\".yes-button\").click(function (e) {\r\n    let keys = Object.keys(sheets);\r\n    let deletedSheet = selectedSheet;\r\n    keys.forEach((sheet, index) => {\r\n      console.log(\"deleted\", deletedSheet);\r\n      if (sheet === deletedSheet) {\r\n        console.log(\"index\", index);\r\n        if (index == keys.length - 1) {\r\n          selectSheet($(\".sheet-tab\")[0]);\r\n        } else {\r\n          selectSheet($(\".sheet-tab\")[index + 1]);\r\n        }\r\n        delete sheets[deletedSheet];\r\n      }\r\n    });\r\n    $(\".sheet-tab\").each((idx, elem) => {\r\n      if ($(elem).text() === deletedSheet) {\r\n        $(elem).remove();\r\n      }\r\n    });\r\n    $(\".sheet-modal-parent\").remove();\r\n    totalSheets--;\r\n    saved = false;\r\n  });\r\n}\r\n\r\n$(\".left-scroller\").click(function (e) {\r\n  let keys = Object.keys(sheets);\r\n  let index = keys.indexOf(selectedSheet);\r\n  if (index != 0) {\r\n    selectSheet($(\".sheet-tab\")[index - 1]);\r\n    $(\".sheet-tab\")[index - 1].scrollIntoView({ behaviour: \"smooth\" });\r\n  }\r\n});\r\n\r\n$(\".right-scroller\").click(function (e) {\r\n  let keys = Object.keys(sheets);\r\n  let index = keys.indexOf(selectedSheet);\r\n  if (index != keys.length - 1) {\r\n    selectSheet($(\".sheet-tab\")[index + 1]);\r\n    $(\".sheet-tab\")[index + 1].scrollIntoView({ behaviour: \"smooth\" });\r\n  }\r\n});\r\n\r\n$(\".menu-selector\").change(function (e) {\r\n  const value = $(this).val();\r\n  const id = $(this).attr(\"id\");\r\n  if (id == \"font-family\") {\r\n    $(\".input-cell.selected\").css(\"font-family\", value);\r\n    updateCellData(\"font-family\", value);\r\n  } else {\r\n    const num = parseInt(value);\r\n    $(\".input-cell.selected\").css(\"font-size\", num);\r\n    updateCellData(\"font-size\", num);\r\n  }\r\n});\r\n\r\nfunction updateCellData(property, value) {\r\n  let oldCellData = JSON.stringify(sheets);\r\n  if (value != defaultProperties[property]) {\r\n    $(\".input-cell.selected\").each((idx, data) => {\r\n      let [rowId, colId] = getRowColId(data);\r\n      if (sheets[selectedSheet][rowId - 1] == undefined) {\r\n        sheets[selectedSheet][rowId - 1] = {};\r\n        sheets[selectedSheet][rowId - 1][colId - 1] = {\r\n          ...defaultProperties,\r\n          upStream: [],\r\n          downStream: [],\r\n        };\r\n        sheets[selectedSheet][rowId - 1][colId - 1][property] = value;\r\n      } else {\r\n        if (sheets[selectedSheet][rowId - 1][colId - 1] == undefined) {\r\n          sheets[selectedSheet][rowId - 1][colId - 1] = {\r\n            ...defaultProperties,\r\n            upStream: [],\r\n            downStream: [],\r\n          };\r\n          sheets[selectedSheet][rowId - 1][colId - 1][property] = value;\r\n        } else {\r\n          sheets[selectedSheet][rowId - 1][colId - 1][property] = value;\r\n        }\r\n      }\r\n    });\r\n  } else {\r\n    $(\".input-cell.selected\").each((idx, data) => {\r\n      let [rowId, colId] = getRowColId(data);\r\n      if (\r\n        sheets[selectedSheet][rowId - 1] &&\r\n        sheets[selectedSheet][rowId - 1][colId - 1]\r\n      ) {\r\n        sheets[selectedSheet][rowId - 1][colId - 1][property] = value;\r\n        if (\r\n          JSON.stringify(sheets[selectedSheet][rowId - 1][colId - 1]) ==\r\n          JSON.stringify(defaultProperties)\r\n        ) {\r\n          delete sheets[selectedSheet][rowId - 1][colId - 1];\r\n          if (Object.keys(sheets[selectedSheet][rowId - 1]).length == 0)\r\n            delete sheets[selectedSheet][rowId - 1];\r\n        }\r\n      }\r\n    });\r\n  }\r\n  if (oldCellData !== JSON.stringify(sheets)) {\r\n    saved = false;\r\n  }\r\n}\r\n\r\n$(\"#menu-file\").click(function (e) {\r\n  const fileModal = $(` \r\n  <div class=\"file-modal-parent\">\r\n  <div class=\"file-modal\">\r\n  <div class=\"file-options-modal\">\r\n      <div class=\"close\">\r\n          <div class=\"material-icons close-icon\">arrow_circle_down</div>\r\n          <div>Close</div>\r\n      </div>\r\n      <div class=\"new\">\r\n          <div class=\"material-icons new-icon\">insert_drive_file</div>\r\n          <div>New</div>\r\n      </div>\r\n      <div class=\"open\">\r\n          <div class=\"material-icons open-icon\">folder_open</div>\r\n          <div>Open</div>\r\n      </div>\r\n      <div class=\"save\">\r\n          <div class=\"material-icons save-icon\">save</div>\r\n          <div>Save</div>\r\n      </div>\r\n  </div>\r\n  <div class=\"file-recent-modal\"></div>\r\n</div></div>`);\r\n  $(\".container\").append(fileModal);\r\n  $(\".close\").click(function (e) {\r\n    console.log(\"clicked\");\r\n    $(\".file-modal-parent\").remove();\r\n  });\r\n\r\n  $(\".file-modal-parent\").click(function (e) {\r\n    $(this).remove();\r\n  });\r\n\r\n  $(\".file-modal\").click(function (e) {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    e.stopImmediatePropagation();\r\n  });\r\n\r\n  $(\".open\").click(function (e) {\r\n    openFile();\r\n    $(\".file-modal-parent\").remove();\r\n  });\r\n\r\n  $(\".new\").click(function (e) {\r\n    $(\".file-modal-parent\").remove();\r\n    if (!saved) {\r\n      const sureModal = $(`<div class=\"sheet-modal-parent\">\r\n       <div class=\"sheet-delete-modal\">\r\n           <div class=\"sheet-modal-title\">${$(\".title\").text()}</div>\r\n           <div class=\"sheet-modal-detail-container\">\r\n               <span class=\"sheet-modal-detail-title\">Do you want to save the unsaved changes?</span>\r\n           </div>\r\n           <div class=\"sheet-modal-confirmation\">\r\n               <div class=\"button yes-button\">\r\n                   Yes\r\n               </div>\r\n               <div class=\"button no-button\">No</div>\r\n           </div>\r\n       </div>\r\n     </div>`);\r\n      $(\".container\").append(sureModal);\r\n      $(\".yes-button\").click(function (e) {\r\n        $(\".sheet-modal-parent\").remove();\r\n        saveFile(true);\r\n      });\r\n      $(\".no-button\").click(function (e) {\r\n        $(\".sheet-modal-parent\").remove();\r\n        openNewFile();\r\n      });\r\n    } else {\r\n      openNewFile();\r\n    }\r\n  });\r\n\r\n  $(\".save\").click(function (e) {\r\n    $(\".file-modal-parent\").remove();\r\n    saveFile();\r\n  });\r\n});\r\n\r\nfunction openNewFile() {\r\n  emptyPreviousSheet();\r\n  selectedSheet = \"Sheet1\";\r\n  sheets = { Sheet1: {} };\r\n  totalSheets = 1;\r\n  lastSheetAdded = 1;\r\n  $(\".sheet-tab\").remove();\r\n  $(\".sheet-tab-container\").append(\r\n    `<div class=\"sheet-tab selected\">Sheet1</div>`\r\n  );\r\n  $(\".title\").text(\"Excel-Book\");\r\n  $(\"#row-1-col-1\").click();\r\n}\r\n\r\nfunction saveFile(newClicked) {\r\n  const saveModal = $(`<div class=\"sheet-modal-parent\">\r\n    <div class=\"sheet-rename-modal\">\r\n        <div class=\"sheet-modal-title\">Save File</div>\r\n        <div class=\"sheet-modal-input-container\">\r\n            <span class=\"sheet-modal-input-title\">Enter File Name:</span>\r\n            <input class=\"sheet-modal-input\" type=\"text\" />\r\n        </div>\r\n        <div class=\"sheet-modal-confirmation\">\r\n            <div class=\"button yes-button\">OK</div>\r\n            <div class=\"button no-button\">Cancel</div>\r\n        </div>\r\n    </div>\r\n  </div>`);\r\n  $(\".container\").append(saveModal);\r\n  $(\".no-button\").click(function (e) {\r\n    $(\".sheet-modal-parent\").remove();\r\n  });\r\n  $(\".yes-button\").click(function (e) {\r\n    $(\".title\").text($(\".sheet-modal-input\").val());\r\n    let a = document.createElement(\"a\");\r\n    a.href = `data:application/json,${encodeURIComponent(\r\n      JSON.stringify(sheets)\r\n    )}`;\r\n    console.log(a);\r\n    a.download = $(\".title\").text() + \".json\";\r\n    $(\".container\").append(a);\r\n    a.click();\r\n    a.remove();\r\n    saved = true;\r\n    $(\".sheet-modal-parent\").remove();\r\n    if (newClicked) {\r\n      openNewFile();\r\n    }\r\n  });\r\n}\r\n\r\nfunction openFile() {\r\n  let inputFile = $(`<input accept=\"application/json\" type=\"file\" />`);\r\n  $(\".container\").append(inputFile);\r\n  inputFile.click();\r\n  inputFile.change(function (e) {\r\n    let file = e.target.files[0];\r\n    $(\".title\").text(file.name.split(\".json\")[0]);\r\n    let reader = new FileReader();\r\n    reader.readAsText(file);\r\n    reader.onload = () => {\r\n      emptyPreviousSheet();\r\n      $(\".sheet-tab\").remove();\r\n      sheets = JSON.parse(reader.result);\r\n      console.log(sheets);\r\n      let keys = Object.keys(sheets);\r\n      lastlyAddedSheet = 1;\r\n      for (let i of keys) {\r\n        if (i.includes(\"Sheet\")) {\r\n          let splittedSheetArray = i.split(\"Sheet\");\r\n          if (splittedSheetArray.length == 2 && !isNaN(splittedSheetArray[1])) {\r\n            lastlyAddedSheet = parseInt(splittedSheetArray[1]);\r\n          }\r\n        }\r\n        $(\".sheet-tab-container\").append(\r\n          `<div class=\"sheet-tab selected\">${i}</div>`\r\n        );\r\n      }\r\n      addSheetListeners();\r\n      $(\".sheet-tab\").removeClass(\"selected\");\r\n      $($(\".sheet-tab\")[0]).addClass(\"selected\");\r\n      selectedSheet = keys[0];\r\n      totalSheets = keys.length;\r\n      loadNewSheet();\r\n      inputFile.remove();\r\n    };\r\n  });\r\n}\r\nlet clipBoard;\r\nlet contentCutted;\r\n$(\".copy,.cut\").click(function (e) {\r\n  if ($(this).text() === \"content_cut\") contentCutted = true;\r\n  clipBoard = { startCell: [], cellData: {} };\r\n  clipBoard.startCell = getRowColId($(\".input-cell.selected\")[0]);\r\n  let { cellData } = clipBoard;\r\n  $(\".input-cell.selected\").each((idx, elem) => {\r\n    let [row, col] = getRowColId(elem);\r\n    if (\r\n      sheets[selectedSheet][row - 1] &&\r\n      sheets[selectedSheet][row - 1][col - 1]\r\n    ) {\r\n      if (!cellData[row]) {\r\n        cellData[row] = {};\r\n      }\r\n      cellData[row][col] = { ...sheets[selectedSheet][row - 1][col - 1] };\r\n      if (contentCutted) {\r\n        delete sheets[selectedSheet][row - 1][col - 1];\r\n        if (Object.keys(sheets[selectedSheet][row - 1]).length == 0)\r\n          delete sheets[selectedSheet][row - 1];\r\n        let cell = $(`#row-${parseInt(row)}-col-${parseInt(col)}`);\r\n        cell.text(\"\");\r\n        cell.css({\r\n          \"font-family\": \"Noto Sans\",\r\n          \"font-size\": 14,\r\n          \"font-weight\": 400,\r\n          \"font-style\": \"none\",\r\n          \"text-decoration\": \"none\",\r\n          \"text-align\": \"left\",\r\n          color: \"#444\",\r\n          \"background-color\": \"#fff\",\r\n        });\r\n      }\r\n    }\r\n  });\r\n  console.log(clipBoard);\r\n});\r\n\r\n$(\".paste\").click(function (e) {\r\n  let sCell = getRowColId($(\".input-cell.selected\")[0]);\r\n  let { cellData } = clipBoard;\r\n  let rows = Object.keys(cellData);\r\n  console.log(rows);\r\n  for (i of rows) {\r\n    let cols = Object.keys(cellData[i]);\r\n    for (j of cols) {\r\n      let rowDiff = parseInt(i) - clipBoard.startCell[0];\r\n      let colDiff = parseInt(j) - clipBoard.startCell[1];\r\n      if (!sheets[selectedSheet][sCell[0] + rowDiff - 1]) {\r\n        sheets[selectedSheet][sCell[0] + rowDiff - 1] = {};\r\n      }\r\n      sheets[selectedSheet][sCell[0] + rowDiff - 1][sCell[1] + colDiff - 1] =\r\n        cellData[i][j];\r\n    }\r\n  }\r\n  loadNewSheet();\r\n  if (contentCutted) {\r\n    contentCutted = false;\r\n    clipBoard = { startCell: [], cellData: {} };\r\n  }\r\n});\r\n\r\n$(\"#formula-input\").blur(function (e) {\r\n  if ($(\".input-cell.selected\").length > 0) {\r\n    let formula = $(this).text();\r\n    // console.log($(this).val());\r\n    let splitArr = formula.split(\" \");\r\n    let elements = [];\r\n    for (let i of splitArr) {\r\n      if (i.length >= 2) {\r\n        i = i.replace(\"(\", \"\");\r\n        i = i.replace(\")\", \"\");\r\n        elements.push(i);\r\n      }\r\n    }\r\n    $(\".input-cell.selected\").each((index, elem) => {\r\n      if (updateStream(elem, elements)) {\r\n        console.log(\"passed\");\r\n      } else {\r\n        console.log(\"not\");\r\n      }\r\n    });\r\n    console.log(elements);\r\n  } else {\r\n    alert(\"!Please select a cell to apply the formula\");\r\n  }\r\n});\r\n\r\nfunction updateStream(elem, elements) {\r\n  let [rowId, colId] = getRowColId(elem);\r\n  let selfCode = $(`.column-${colId}`).attr(\"id\") + rowId;\r\n  if (elements.includes(selfCode)) {\r\n    return false;\r\n  }\r\n  return true;\r\n}\r\n","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else if (location.reload) { // `location` global exists in a web worker context but lacks `.reload()` function.\n        location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel]  Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel]   ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\"></span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}